let lastX,lastY,canvas,canvasCtx,mousePressed=!1,brushColor="#000",brushSize=5;function initApp(){let e=document.getElementById("mousePos");e.style="display: block;",window.addEventListener("touchmove",t=>{let n="X:"+(t.touches[0].pageX+"").substr(0,7)+"\nY:"+(t.touches[0].pageY+"").substr(0,7);e.innerHTML=n}),window.addEventListener("mousemove",t=>{let n="X:"+t.pageX+"\nY:"+t.pageY;e.innerHTML=n}),canvas=document.getElementById("myCanvas"),canvasCtx=canvas.getContext("2d"),window.screen.width<=500?(canvas.width=window.innerWidth,canvas.height=.65*window.innerHeight,console.log("start: mobile",canvas.height)):(canvas.width=window.innerWidth,canvas.height=window.innerHeight/1.2,console.log("start: desktop")),window.onresize=e=>{window.screen.width<=500?(canvas.width=window.innerWidth,canvas.height=.65*window.innerHeight,console.log("mobile")):(canvas.width=window.innerWidth,canvas.height=window.innerHeight/1.2,console.log("desktop"))},canvas.addEventListener("touchmove",(function(e){console.log("touchmove");var t=e.touches[0],n=new MouseEvent("mousemove",{clientX:t.clientX,clientY:t.clientY});canvas.dispatchEvent(n)}),!1),canvas.addEventListener("touchstart",(function(e){mousePressed=!0,console.log("touchstart"),draw(e.pageX-$(this).offset().left,e.pageY-$(this).offset().top,!1)}),!1),canvas.addEventListener("touchend",(function(e){mousePressed=!1,console.log("touchend")}),!1),canvas.addEventListener("touchcancel",(function(e){mousePressed=!1}),!1),canvas.addEventListener("touchmove",(function(e){mousePressed&&draw(e.pageX-$(this).offset().left,e.pageY-$(this).offset().top,!0)}),!1),canvas.addEventListener("mousedown",(function(e){mousePressed=!0,console.log("%cMOUSE DOWN","background: #111; font-family:'Roboto Light'; font-weight: bold; color:white"),draw(e.pageX-$(this).offset().left,e.pageY-$(this).offset().top,!1)})),canvas.addEventListener("mousemove",(function(e){mousePressed&&draw(e.pageX-$(this).offset().left,e.pageY-$(this).offset().top,!0)})),canvas.addEventListener("mouseup",(function(e){mousePressed=!1,console.log("%cMOUSE UP","background: #111; font-family:'Roboto Light'; font-weight: bold; color:white")})),canvas.addEventListener("mouseleave",(function(e){mousePressed=!1}));let t=document.getElementById("clearBtn");$("#clearBtn").on("mouseover",e=>{document.getElementById("my-clear-icon").classList.toggle("spin")}),$("#clearBtn").on("mouseout",e=>{document.getElementById("my-clear-icon").classList.toggle("spin")}),t.addEventListener("click",clearArea);let n=document.getElementById("downloadBtn");n.addEventListener("mouseover",e=>{document.getElementById("my-download-icon").classList.toggle("slide-down")}),n.addEventListener("mouseout",e=>{document.getElementById("my-download-icon").classList.toggle("slide-down")}),n.addEventListener("click",(function(e){console.log("%cSAVING","background: firebrick; font-family:'Roboto Light'; font-weight: bold; color:white"),n.href=canvas.toDataURL("image/png"),n.download="image.png"}),!1),$("#myRange").on("change",e=>{document.getElementById("brushSize").innerHTML=e.target.value})}function draw(e,t,n){n&&(canvasCtx.strokeStyle=brushColor,canvasCtx.lineWidth=$("#myRange").val(),canvasCtx.lineJoin="round",canvasCtx.beginPath(),canvasCtx.moveTo(lastX,lastY),canvasCtx.lineTo(e,t),console.info(`%c ${lastX}, ${lastY} %c=>%c ${e}, ${t} `,"background: #transparent; color: white; font-family:'Roboto Light'; font-weight: bold","background: #transparent; color: rgba(255, 60, 10, 1); font-family:inherit; font-weight: bold","background: #transparent; color: white; font-family:'Roboto Light'; font-weight: bold"),canvasCtx.closePath(),canvasCtx.stroke()),lastX=e,lastY=t}function clearArea(){canvasCtx.setTransform(1,0,0,1,0,0),canvasCtx.clearRect(0,0,canvasCtx.canvas.width,canvasCtx.canvas.height)}function pickColor(e,t){brushColor=e;let n=document.getElementsByClassName("color");$.each(n,(e,n)=>{n.id===t.id?document.getElementById(n.id).classList.add("color--picked"):document.getElementById(n.id).classList.remove("color--picked")})}